{% extends 'base.html' %}

{% block title %}Events{% endblock %}

{% block body %}
  <div class="container">
    <h2>All Events</h2>
    <ul id="event-list">
      {% for event in all_events %}
        {% if event not in joined_events %}
          <li class="event-item" id="event-{{ event.id }}">
            <strong>Title:</strong> {{ event.title }}<br>
            <strong>Date:</strong> {{ event.date }}<br>
            <strong>Location:</strong> {{ event.location }}<br>
            <a href="{{ url_for('project.view_event', event_id=event.id) }}" class="btn btn-primary mt-2">View Details</a>
            <button class="btn btn-primary join-event-btn" data-event-id="{{ event.id }}">Join Event</button>
            
            <!-- Display the event details here -->
            <div class="event-details" id="event-details-{{ event.id }}">
              <!-- Add event details you want to display -->
              <!-- For example: <strong>Details:</strong> {{ event.details }}<br> -->
            </div>
          </li>
        {% endif %}
      {% endfor %}
    </ul>

    <a href="{{ url_for('project.joined_events') }}">View Joined Events</a>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script>
    $(document).ready(function() {
      $('.join-event-btn').on('click', function() {
        var eventId = $(this).data('event-id');

        $.post('{{ url_for("project.volunteer_join_event", event_id=0) }}'.replace('0', eventId), function(data) {
          $('#event-' + eventId).remove();
        });
      });
    });
  </script>
  <a class="btn btn-primary mt-4" href="{{ url_for('project.historyevents') }}">ALL EVENTS</a>
{% endblock %}
